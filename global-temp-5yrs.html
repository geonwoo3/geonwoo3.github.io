<!DOCTYPE html>
<html>
<script src='http://d3js.org/ds.v5.min.js'></script>


<title> CS 416 Narrative Visualization Project </title>
<h1> Global Warming Analysis </h1>




<p class="stats">Regional Choices</p>
<style>
    rect {fill: antiquewhite;}
    p.stats { position: absolute; left: 5px; top: 250px; }
    select { position: absolute; left: 5px; top: 290px; }
    div.slide { position: absolute; left: 5px; top: 220px; }
</style>
<select id="stats"></select>








<body>

<svg width = 10000 height = 1500></svg>



<script>

async function init() {

    var svg = d3.select("svg");
    var margin = 50;

    
    const data = await d3.csv("global-temp-5yr_csv.csv");
    const year_d = data.map(d => +d.Year);
    const land_d = data.map(d => +d.Land);
    const landAndOcean_d = data.map(d => +d.LandAndOcean);
    const shem_d = data.map(d => +d.SHem);
    const nhem_d = data.map(d => +d.NHem);
    
    var xscale = d3.scaleBand().range([0, 2014 - 1880]).domain(year_d);
    var yscale = d3.scaleLinear().range([100,0]).domain([-1.00,1.00]);
    var h = d3.scaleLinear().range([0, 100]).domain([-1.00, 1.00]);
    var w = xscale.bandwidth();





    var stats = ['Land', 'Land and Ocean', 'North Hemisphere', 'South Hemisphere'];
    d3.select('select')
    .selectAll('groups')
    .data(stats)
    .enter()
    .append('option')
    .text(function (d) { return d; })
    .property("selected", function (d) {return d === 'Land'; });

    d3.select("#stats")
    .on("change", function() {
        if (this.value === 'Land') {
            land(this.value);
        } else if (this.value === 'Land and Ocean') {
            landAndOcean(this.value);
        } else if (this.value == 'North Hemisphere') {
            nhem(this.value);
        } else {
            shem(this.value);
        }
    ;});

    function land(value) {
        console.log(value);
        d3.select('svg').selectAll("rect").remove();

        svg.append("g").attr("transform", "translate(50,50)")
        .data(data)
        .enter()
        .append("rect")
        .attr('transform','translate(175,75)')
        .attr("x", function(d) { return xscale(year_d); })
        .attr('y',function(d) {return yscale(land_d);})
        .attr("width", w)
        .attr('height',function(d) {return h(land_d);});
        

        
    };

    function landAndOcean(value) {
        console.log(value);
        d3.select('svg').selectAll("rect").remove();

        svg.append("g").attr("transform", "translate(50,50)")
        .data(data)
        .enter()
        .append("rect")
        .attr('transform','translate(175,75)')
        .attr("x", function(d) { return xscale(year_d); })
        .attr('y',function(d) {return yscale(landAndOcean_d);})
        .attr("width", w)
        .attr('height',function(d) {return h(landAndOcean_d);});
        
       
    };

    function nhem(value) {
        console.log(value);
        d3.select('svg').selectAll("rect").remove();

        svg.append("g").attr("transform", "translate(50,50)")
        .data(data)
        .enter()
        .append("rect")
        .attr('transform','translate(175,75)')
        .attr("x", function(d) { return xscale(year_d); })
        .attr('y',function(d) {return yscale(nhem_d);})
        .attr("width", w)
        .attr('height',function(d) {return h(nhem_d);});

    };


    function shem(value) {
        console.log(value);
        d3.select('svg').selectAll("rect").remove();

        svg.append("g").attr("transform", "translate(50,50)")
        .data(data)
        .enter()
        .append("rect")
        .attr('transform','translate(175,75)')
        .attr("x", function(d) { return xscale(year_d); })
        .attr('y',function(d) {return yscale(shem_d);})
        .attr("width", w)
        .attr('height',function(d) {return h(shem_d);});

    };

    // svg
    //     .append('g')
    //     .selectAll('rect')
    //     .data(globalTemp5yr)
    //     .enter()
    //     .append('text')
    //     .text(function(d) { return d.Land})
    //     .attr('id', 'barstat')
    //     .attr('transform','translate(185,45)')
    //     .attr("text-anchor", "middle")
    //     .attr("fill", "black")
    //     .attr('x', function(d) { return x(d.Year); })
    //     .attr('y', function(d) { return y(d.Land); })
    //     .attr('dy', '1.5em')

    // svg
    //     .append('g')
    //     .attr('transform','translate(175,75)')
    //     .call(d3.axisLeft(y));
    // svg
    //     .append('g')
    //     .attr('transform','translate(175,575)')
    //     .call(d3.axisBottom(x))
    //     .selectAll('text')
    //     .attr("y", 0)
    //     .attr("x", 9)
    //     .attr("dy", ".35em")
    //     .attr('transform','rotate(90)')
    //     .style("text-anchor", "start");

    svg.append("g").attr("transform", "translate(50,50)").selectAll("rect")
    .data(data).enter()
    .append("rect")
    .attr("x", function(d) { return xscale(d); })
    .attr("y", function(d) { return yscale(d); })
    .attr("width", x.bandwidth())
    .attr("height", function(d) { return h(d); });

    svg.append("g")
    .attr("transform","translate("+margin+","+margin+")")
    .call(d3.axisLeft(yscale));

    svg.append("g")
    .attr("transform", "translate("+margin+","+300+")")
    .call(d3.axisBottom(xscale));




}
init()

</script>


</body>
</html>