<!DOCTYPE html>
<html>
<script src='https://d3js.org/d3.v5.min.js'></script>


<title> CS 416 Narrative Visualization Project </title>
<h1> Global Warming Analysis </h1>




<p class="stats">Regional Choices</p>
<style>
    rect {fill: antiquewhite;}
    p.stats { position: absolute; left: 5px; top: 250px; }
    select { position: absolute; left: 5px; top: 290px; }
    div.slide { position: absolute; left: 5px; top: 220px; }
</style>
<select id="stats"></select>








<body>

<svg width = 10000 height = 10000></svg>



<script>

async function init() {

    var svg = d3.select("svg");
    var g = svg.append('g').attr("transform", "translate("+margin+", "+margin+")");
    var margin = 50;

    
    const data = await d3.csv("global-temp-5yr_csv.csv");
    const year_d = data.map(d => +d.Year);
    const land_d = data.map(d => +d.Land);
    const landAndOcean_d = data.map(d => +d.LandAndOcean);
    const shem_d = data.map(d => +d.SHem);
    const nhem_d = data.map(d => +d.NHem);
    
    var xscale = d3.scaleBand().range([0, 1000]).domain([1880, 2014]);
    var yscale = d3.scaleLinear().range([1500,0]).domain([1, -1]);
    var hh = d3.scaleLinear().range([0, 1500]).domain([-1, 1])

    var scale_land = land_d.map(value => hh(value));
    var scale_landAndOcean = d3.scaleLinear().domain([landAndOcean_d]).range([0, 1500]);
    var scale_shem = d3.scaleLinear().domain([shem_d]).range([0, 1500]);
    var scale_nhem = d3.scaleLinear().domain([nhem_d]).range([0, 1500]);

    var w = xscale.bandwidth();





    var stats = ['Land', 'Land and Ocean', 'North Hemisphere', 'South Hemisphere'];

    d3.select('select')
    .selectAll('groups')
    .data(stats)
    .enter()
    .append('option')
    .text(function (d) { return d; })
    .property("selected", function (d) {return d === 'Land'; });

    d3.select("#stats")
    .on("change", function() {
        if (this.value === 'Land') {
            land(this.value);
        } else if (this.value === 'Land and Ocean') {
            landAndOcean(this.value);
        } else if (this.value == 'North Hemisphere') {
            nhem(this.value);
        } else {
            shem(this.value);
        }
    ;});




    function land(value) {
        
        console.log(value);

        g.selectAll('rect').remove();

        g.selectAll('rect')
        .data(data)
        .enter()
        .append("rect")
        .attr("x", function(d) { return xscale(d); })
        .attr("y", function(d) {return yscale(d);})
        .attr("width", w)
        .attr("height",function(d, i) {return scale_land[i];});
        

        
    };

    function landAndOcean(value) {
        console.log(value);
        d3.select('svg').selectAll("rect").remove();

        svg.append("g").attr("transform", "translate(50,50)")
        .data(data)
        .enter()
        .append("rect")
        .attr('transform','translate(175,75)')
        .attr("x", function(d) { return xscale(year_d); })
        .attr('y',function(d) {return yscale(landAndOcean_d);})
        .attr("width", w)
        .attr('height',function(d) {return scale_landAndOcean(landAndOcean_d);});
        
       
    };

    function nhem(value) {
        console.log(value);
        d3.select('svg').selectAll("rect").remove();

        svg.append("g").attr("transform", "translate(50,50)")
        .data(data)
        .enter()
        .append("rect")
        .attr('transform','translate(175,75)')
        .attr("x", function(d) { return xscale(year_d); })
        .attr('y',function(d) {return yscale(nhem_d);})
        .attr("width", w)
        .attr('height',function(d) {return scale_nhem(nhem_d);});

    };


    function shem(value) {
        console.log(value);
        d3.select('svg').selectAll("rect").remove();

        svg.append("g").attr("transform", "translate(50,50)")
        .data(data)
        .enter()
        .append("rect")
        .attr('transform','translate(175,75)')
        .attr("x", function(d) { return xscale(year_d); })
        .attr('y',function(d) {return yscale(shem_d);})
        .attr("width", w)
        .attr('height',function(d) {return scale_land(shem_d);});

    };


    

    svg.append("g")
    .attr("transform","translate("+margin+","+margin+")")
    .call(d3.axisLeft(yscale));

    svg.append("g")
    .attr("transform", "translate("+50+","+300+")")
    .call(d3.axisBottom(xscale));


}
init()


</script>


</body>
</html>