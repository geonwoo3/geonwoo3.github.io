<!DOCTYPE html>
<html>
<script src='https://d3js.org/d3.v5.min.js'></script>


<title> CS 416 Narrative Visualization Project </title>
<h1> Global Warming Analysis </h1>




<p class="stats">Country</p>
<style>
    path {stroke: black;}
</style>
<select id="stats"></select>





<body>

<svg width = 5000 height = 2000></svg>



<script>

async function init() {
    var margin = 50;
    var svg = d3.select("svg");
    var g = svg.append('g').attr("transform", "translate("+500+", "+500+")");
    

    
    const data = await d3.csv("fossil-fuel-co2-emissions-by-nation_csv.csv");
    const countries = data.map(d => +d.Country);
    const solidFuel = data.map(d => +d.SolidFuel);
    const gasFuel = data.map(d => +d.GasFuel);
    const cement = data.map(d => +d.Cement);
    const gasFlaring = data.map(d => +d.GasFlaring);
    const liquidFuel = data.map(d => +d.LiquidFuel);
    

    
    var color = ['red','violet','lightyellow','black','blue'];
    var pie = d3.pie();
    var arc = d3.arc().innerRadius(0).outerRadius(200);




    var stats = countries;

    d3.select('select')
    .selectAll('groups')
    .data(stats)
    .enter()
    .append('option')
    .text(function (d) { return d; })
    .property("selected", function (d) {return d === 'AFGHANISTAN'; });

    d3.select("#stats")
    .on("change", function() {
        findData(this.value);
    });




    function findData(value) {
        
        console.log(value);

        var idx = countries.indexOf(value);
        console.log(idx)
        resourceValue = [solidFuel[idx], liquidFuel[idx], gasFuel[idx], cement[idx], gasFlaring[idx]];


        g.selectAll('path').remove();

        svg.selectAll("path")
        .data(pie(resourceValue))
        .enter()
        .append("path")
        .attr("d", arc)
        .attr("fill", function(d, i) {return color[i];});

        

        
    };


    afg = [1194,1393,74,14];

    g.selectAll("path")
        .data(pie(afg))
        .enter()
        .append("path")
        .attr("d", arc)
        .attr("fill", function(d, i) {return color[i];});


}
init()


</script>


</body>
</html>